# 2 并行计算机体系结构

### 并行结构

并行计算机
> 由一组处理单元组成,处理单元通过相互之间的通信协作以更快的速度共同完成一项大规模的计算任务

最主要组成部分:
* 计算节点
* 节点间的通信与协作

通用的并行架构
![bxjg](./pic/bxjg.png)

### 互联网络

性能指标
* 时延
  * 软件开销(overhead)
  > 网络两端互相收发信息,取决于主机内核
  * 竞争时延
  > 选路所造成的时延,依赖于程序
  * 通道时延(transmission time)
  * 传输时延(transport latency)
  > 通道时延和选路时延之和

  ![latency](./pic/latency.png)
* 带宽(Bandwidth:BW)
  * 端口带宽
  > 从任意端口到另外端口单位时间内传输消息的最大位数(字节数)
  * 聚集带宽
  > 从一半节点到另一般节点单位时间内传输消息的最大位数(字节数)
  * 链路带宽(Link Bandwidth)
  > 单位时间内链路传输消息的最大位数(字节数)
  * 对剖**宽度**
  > 将网络分成两个相等的部分所必须移去的最少边数
  * 对剖**带宽**
  > 每秒钟内在最小对剖平面上通过所有连线的最大信息位数(字节数)  
  > 等于对剖宽度与链路带宽之积
  ![bw](./pic/bw.png)
* 硬件复杂度(Cost)
> 将N个处理机按一定拓扑结构连成网络所需的开关个数
* 可拓展性
* 容错能力


###### 静态互连网络
处理单元间有着固定连接的一类网络,在程序执行期间,这种点到点的连接保持不变
* 一维线性阵列(1-Linear Array)
  > 最简单最基本的互连方式  
  > 每个节只与左,右近邻连接(二近邻连接)
  * 线性(Linear Array)
    * 边: N-1
    * 内节点度数: 2
    * 直径 : N-1
    > 最远两个节点之间的距离
    * 对剖宽度 : 1
  * 环形(Ring)
    > 首尾相连,可以单向也可以双向
    * 节点度 : 2
    * 直径 : N/2(双向环) 或 N-1(单向环)
    * 对剖宽度 : 2
* 二维网孔(2-D Mesh)
  > 每个节点只与其上下左右的近邻相连
    * 普通
      * 节点度数 : 4
      * 网络直径 : $2(\sqrt{N}-1)$
      * 对剖宽度 : $\sqrt{N}$
    * Illiac网孔
      > 垂直方向上环绕,水平方向呈蛇形
      * 节点度恒为4
      * 网络直径 : $\sqrt{N} - 1$
      * 对剖宽度 : $2\sqrt{N}$

    ![illiac](./pic/illiac.png)
    * 2-D Torus(2D环绕)
      > 水平和垂直方向均环绕
      * 节点度数恒为4
      * 网络直径 : $2 \times \frac{\sqrt{N}}{2}$
      * 对剖宽度 : $2\sqrt{N}$

    ![torus](./pic/torus.png)
* 树(Tree)
  * 二叉树
    * 节点度 : 3
    * 对剖宽度 : 1
    * 直径 : $2\times k -2 = 2logN - 1$
    > k 是层数,N为树额总节点树
  * 星形
    * 节点度 : N - 1
    * 对剖宽度 : $\frac{N}{2}$
    * 直径 : 2
  * 胖树
    > 节点间的通路自叶向根逐渐变宽  
    > 对剖宽度随着N的增大而增大

    ![fat](./pic/fat.png)
* 超立方(Hypercube)
  * n-立方($N = 2^n$)
    * 节点度 : n
    * 网络直径 : n
    * 对剖宽度 : N/2
  * 3-立方环
  > 3-立方的每个顶点用一个环代替
    
    ![3lifang](./pic/3lifang.png)
* 蝶形网络(Butterfly)
  * 节点数 : $N = (k+1)2^k$
  * 直径 : 2k
  * 对剖带宽 : $2^k$

比较:

![jnd](./pic/jnd.png)

总结:
* 节点小于4比较理想,若能实现所有节点连接,节点度越小越好
* 节点度越大,连接性越好,但网络连接复杂,成本高
* 对剖带宽越大,网络带宽越大
* 网络直径越大,时延越大
* 对称性会影响可扩展性和路由效率
###### 动态互连网路
用交换开关构成,可按应用程序的要求动态地改变连接组态, 连接是在程序执行过程中实时建立
* 总线(Bus)
  * 节点度 : 1
  * 直径 : 1
  * 规模 : 1
  * 特点
  > 成本低,但扩展性不好,随着处理器增加,每个处理器带宽减少
* 交叉开关(Crossbus Switcher)
  * 
* 多级互连网络(MIN-Multistage Interconnection Network)
###### 标准连接网络
